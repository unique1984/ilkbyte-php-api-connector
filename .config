<?php
/**
 * © Copyright 2019
 * Yasin KARABULAK <info@yasinkarabulak.com>
 * MIT License
 * http://ozgurlisanslar.org.tr/mit/
 */

/*
Versiyonlama:
[major].[minor].[patch].[bug fix]
*/
$version = 'v0.1.0';
!defined("VERSION") ?
    define("VERSION", $version) : null;

$repository = 'https://github.com/unique1984/ilkbyte-php-api-connector';
!defined("REPOSITORY") ?
    define("REPOSITORY", $repository) : null;

/*
!!!!! Sistemin geliştirici modunda mı yoksa ürün modunda mı olduğunu .conf içerisinden sorgulanmaktadır.
    .config.dev dosyasının içerisinde $devMode değeri görmezden gelinmektedir.

Geliştirici modu için true|false

true:
    - .config.dev dosyasındaki tanımlara göre hareket edecektir,
    - curl çağrılarında header, info bilgileri döndürülecektir.

false:
    - .config dosyasındaki değerler geçerlidir.

Eğer .config.dev dosyası yoksa
    .config dosyasının kopyası .config.dev adında oluşturulacaktır.
    devMode = true; avantajı:
        Api key ve secret bilgilerinin yanlışlıkla push edilmemesi için .gitignore içerisine eklenmesidir.
*/
/**
 * @var bool $devMode
 */
$devMode = true;

/*
Api key ve Api secret:
https://github.com/ilkbyte/api.ilkbyte.com/wiki#authentication
*/
/**
 * @var array $apiKey
 */
$apiKey = [
    'access' => '' // Access key clear-text olarak gönderilir.
];

/**
 * @var array $apiSecret
 */
$apiSecret = [
    'secret' => '' // Secret key clear-text olarak gönderilir.
];

/*
SSH Public Key(ler):
Array içerisinde virgülle ayrılmış her bir key=>value yani her bir keyi isimlendirebilirsiniz.
*/
/**
 * @var array $sshKeys
 */
$sshKeys = [
//    'etiket' => 'ssh-key',
    '' => '',
];

/*
PHPApi içerisinde kayıtlı çağrı yöntemleri ve methodları
*/
/**
 * @var array $handler
 */
$handler = [
    // ilk seçenek default handler.
    'curl' => [
        // handler methodları apiCall -> url call, getBinary -> img call
        'apiCall' => ['url', 'parameters', 'devMode'],
        'getBinary' => ''
    ],
    // eklemek isterseniz diğerleri
];

/*
Api Url:
Çağrıların tümünün gönderileceği adres. SSL doğrulaması zorunlu.
*/
/**
 * @var array $apiUrl
 */
$apiUrl = 'https://api.ilkbyte.com';

/*
Endpoint Url Listesi ve varsa parametreleri:
Çağrı yapılabilecek url listesi ve parametrelerinin listesi, bunun dışında çağrı yapılamaz.
https://github.com/ilkbyte/api.ilkbyte.com/wiki#endpoint-listesi

PHPApi getter ve setterlar aşağıdaki listeye göre hazırlanacaktır, yani
liste değişecek olursa api içerisinde de gerekli değişiklik yapılmak zorunda!
*/
/**
 * @var array $endPointUrlList
 */
$endPointUrlList = [
    '/',    // Test için kullanılır.

    /* SERVER */
    '/server/list', // Aktif sunucuların listesine ulaşmanızı sağlar
    '/server/list/all', // Tüm sunucuların listesine ulaşmanızı sağlar
    '/server/create',   // Sunucu oluşturmak için gerekli parametreleri sağlar

    // https://github.com/ilkbyte/api.ilkbyte.com/wiki#endpoint-servercreateconfig
    '/server/create/config' => [    // Yeni bir sunucu oluşturmak için kullanılır
        'username' => '%s',    // Sunucu kullanıcı adı (eğer root seçilirse alt kullanıcı açmaz)
        'password' => '%s',    // Sunucu kullanıcı şifresi
        'name' => '%s',    // Alfanümerik olarak sunucu adı
        'os_id' => '%d',    // İşletim sistemi ID. Eğer hazır uygulama kurulacaksa 0 olmalı [/server/create sağlıyor]
        'app_id' => '%d',    // Hazır uygulama ID. Eğer işletim sistemi kurulacaksa 0 olmalı
        'package_id' => '%s',    // Oluşturulacak sunucu için paket ID numarasıdır
        'sshkey' => '%s',    // Public SSH anahtarı clear-text olarak gönderilir. Birden fazla için virgül kullanılır.
    ],
    '/server/manage/%s/show',   // Sunucu durumunun görüntülenmesini sağlar
    '/server/manage/%s/monitor',    // (Geliştiriliyor) Sunucu monitoring verilerinin görüntülenmesini sağlar

    /* POWER */
    // https://github.com/ilkbyte/api.ilkbyte.com/wiki#endpoint-servermanageservernamepower
    '/server/manage/%s/power' => [  // Sunucu güç yönetimi için kullanılır
        'set' => [
            0 => 'start',     // Kapalı olan sunucuyu çalıştırır
            1 => 'shutdown',     // Sunucuya shutdown isteği gönderir
            2 => 'reboot',     // Sunucuyu yeniden başlatır
            3 => 'destroy',     // Sunucuyu direkt olarak kapatır
        ],
    ],

    /* RDNS */
    // https://github.com/ilkbyte/api.ilkbyte.com/wiki#endpoint-servermanageservernameiprdns
    '/server/manage/%s/ip/rdns' => [    // Sunucu için IP rdns kaydı değişikliği sağlar
        'ip' => '%s',   // İşlem yapılacak IP adresi bilgisidir. [callback ip validation]
        'rdns' => '%s', // IP adresi için tanımlanacak RDNS kaydı bilgisidir
    ],

    /* LOGS */
    '/server/manage/%s/ip/logs',    // Sunucuya gelen saldırı loglarının okunmasını sağlar

    /* BACKUP, SNAPSHOT */
    '/server/manage/%s/snapshot/list',    // Sunucu snapshot listesini gösterir

    // https://github.com/ilkbyte/api.ilkbyte.com/wiki#endpoint-servermanageservernamesnapshotrevert
    '/server/manage/%s/snapshot/revert',    // Snapshot yüklemesi için kullanılır
    '/server/manage/%s/backup/list',    // Sunucu yedek listesini gösterir

    // https://github.com/ilkbyte/api.ilkbyte.com/wiki#endpoint-servermanageservernamebackuprevert
    '/server/manage/%s/backup/revert',    // Seçilen yedeğin restore edilmesini sağlar

    /* DOMAIN */
    '/domain/list',    // DNS sistemine kayıtlı alan adları listelenir
    '/domain/create',    // DNS sistemine yeni alan adı ekler
    '/domain/manage/%s/show',    // Alan adi DNS kayıtlarını gösterir
    '/domain/manage/%s/add',    // Yeni DNS kaydı ekler
    '/domain/manage/%s/update',    // Mevcut DNS kaydını günceller
    '/domain/manage/%s/delete',    // Mevcut DNS kaydını siler
    '/domain/manage/%s/push',    // Yapılan değişiklikleri DNS sunucularına gönderir

    /* ACCOUNT */
    '/account',    // Hesap bilgilerini görüntülemenizi sağlar
    '/account/payment',    // (Geliştiriliyor) Hesaba bakiye yüklemek için kullanılır
];

/////////////// config /////////////
$configParameters = [
    'devMode' => $devMode,
    'apiKey' => $apiKey,
    'apiSecret' => $apiSecret,
    'sshKeys' => $sshKeys,
    'handler' => [ array_key_first($handler) => reset($handler) ],
    'apiUrl' => $apiUrl,
    'endPointUrlList' => $endPointUrlList
];